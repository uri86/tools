#!/bin/bash

# === Resolve real path ===
SCRIPT_DIR="$(cd "$(dirname "$(readlink "$0" || echo "$0")")" && pwd)"
SCRIPT_NAME="$SCRIPT_DIR/ipinfo.py"
VENV_DIR="$SCRIPT_DIR/.venv"
REQUIREMENTS=("requests" "psutil")

# === Create venv ===
if [ ! -d "$VENV_DIR" ]; then
  echo "üîß Creating virtual environment..."
  python3 -m venv "$VENV_DIR" || { echo "‚ùå Failed to create venv"; exit 1; }

  # === Activate venv ===
  source "$VENV_DIR/bin/activate" || { echo "‚ùå Failed to activate venv"; exit 1; }

  # === Install dependencies ===
  pip install --quiet "${REQUIREMENTS[@]}"

else 
  # === Activate venv ===
  source "$VENV_DIR/bin/activate" || { echo "‚ùå Failed to activate venv"; exit 1; }

fi


# === Run the script ===
python "$SCRIPT_NAME" "$@"
